!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["activity-insight"]={})}(this,(function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)};function n(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))}class r{constructor(e){this.storage=e}getItem(e){var t;try{const n=JSON.parse(this.storage.getItem(e)||"{}"),r=(new Date).getTime();return(null===(t=Object.keys(n))||void 0===t?void 0:t.length)&&(null==n?void 0:n.expiry)&&r>(null==n?void 0:n.expiry)?(this.removeItem(e),{}):n}catch(e){return{}}}setItem(e,t,n){try{const r=(new Date).getTime(),o={value:t,currentTime:r};n&&(o.expiry=r+n),this.storage.setItem(e,JSON.stringify(o))}catch(e){console.log(e)}}removeItem(e){try{this.storage.removeItem(e)}catch(e){}}}const o=new r(window.sessionStorage),i="VIEW_STRUCTURE_TRACK";class a{constructor(){const e=o.getItem(i);if(null==e?void 0:e.value)this.track=null==e?void 0:e.value;else{const e={popup:!1};o.setItem(i,e),this.track=e}}updateViewStructure(e,t){const n=Object.assign(Object.assign({},this.track),{[e]:t});o.setItem(i,n),this.track=n}checkViewstructureDisplayed(e){return this.track[e]}}class s{constructor(){this.queue=[]}enqueue(e){this.queue.push(e)}dequeue(){this.queue.shift()}getLength(){return this.queue.length}}class u{constructor(){this.useCaseQueue=new s,this.overlapCount=0,this.cooldownRef=null}init(e){const t=this.useCaseQueue.getLength();if(this.checkOverlap()||!t||this.cooldownRef)return;const n=this.useCaseQueue.queue[0],r=n.variant;if(e){const e=this.getCountDown(r);this.increaseCounter(),this.cooldownRef=setTimeout((()=>{this.decreaseCounter(),this.checkOverlap()?this.resetCooldown():this.insertInDom(n)}),e)}else this.increaseCounter(),this.insertInDom(n)}enqueue(e){this.useCaseQueue.enqueue(e),this.init()}dequeue(){this.useCaseQueue.dequeue(),clearTimeout(this.cooldownRef),this.cooldownRef=null}checkOverlap(){return this.overlapCount>0}getCountDown(e){var t;return parseInt(1e3*(null===(t=e.configuration.overlap)||void 0===t?void 0:t.coolingPeriod))||0}increaseCounter(){this.overlapCount=this.overlapCount+1}decreaseCounter(){this.overlapCount=this.overlapCount-1}insertInDom(e){return n(this,void 0,void 0,(function*(){yield e.callback(),this.dequeue()}))}resetCooldown(){this.cooldownRef&&this.decreaseCounter(),clearTimeout(this.cooldownRef),this.cooldownRef=null}}const c="fpResponse",l="attryb_anonymous_id",d="atb-variants",f={tier1:["Ahmedabad","Bengaluru","Chennai","Delhi","Hyderabad","Kolkata","Mumbai","Pune"],tier2:["Agra","Ajmer","Aligarh","Amravati","Amritsar","Anand","Asansol","Aurangabad","Bareilly","Belagavi","Bhavnagar","Bhiwandi","Bhopal","Bhubaneswar","Bikaner","Bilaspur","Bokaro Steel City","Brahmapur","Burdwan","Chandigarh","Coimbatore","Cuttack","Dahod","Dehradun","Dhanbad","Dombivli","Durgapur","Erode","Faridabad","Ghaziabad","Gorakhpur","Guntur","Gurgaon","Guwahati","Gwalior","Hamirpur","Hubballi-Dharwad","Indore","Jabalpur","Jaipur","Jalandhar","Jalgaon","Jammu","Jamshedpur","Jhansi","Jodhpur","Kalaburagi","Kakinada","Kannur","Kanpur","Karnal","Kochi","Kolhapur","Kollam","Kozhikode","Kurnool","Ludhiana","Lucknow","Madurai","Malappuram","Mathura","Mangaluru","Meerut","Moradabad","Mysuru","Nagpur","Nanded","Nadiad","Nashik","Nellore","Noida","Patna","Puducherry","Purulia","Prayagraj","Raipur","Rajkot","Ranchi","Rourkela","Ratlam","Salem","Siliguri","Solapur","Srinagar","Surat","Thanjavur","Thiruvananthapuram","Thrissur","Tiruchirappalli","Tirunelveli","Tiruvannamalai","Ujjain","Vijayapura","Vadodara","Varanasi","Vasai-Virar City Municipal Corporation","Vijayawada","Visakhapatnam","Vellore","Warangal"],tier3:["All other cities and towns"]},p={formSubmit:"custom_form_submit",click:"custom_template_click",load:"custom_template_load"},v={locationBestSeller:"Location-specific Bestsellers Toaster",frequentlyBoughtTogether:"Frequently Bought Together"},h={NEW_VISITOR:"NEW_VISITOR",VISITOR:"VISITOR",CUSTOMER:"CUSTOMER",CUSTOMER_WITH_ONE_ORDER:"FIRST_TIME_CUSTOMER",HOV:"HOV",LOV:"LOV",VISITOR_LAST_SEEN_GREATER_THAN_ONE_WEEK:"VISITOR_LAST_SEEN_GREATER_THAN_ONE_WEEK",VISITOR_LAST_SEEN_LESS_THAN_ONE_WEEK:"VISITOR_LAST_SEEN_LESS_THAN_ONE_WEEK",TIER_1:"TIER_1",TIER_2:"TIER_2",TIER_3:"TIER_3",USER:"USER",ALL_VISITORS:"ALL_VISITORS"},m=[h.TIER_1,h.TIER_2,h.TIER_3,h.NEW_VISITOR,h.VISITOR_LAST_SEEN_GREATER_THAN_ONE_WEEK,h.VISITOR_LAST_SEEN_LESS_THAN_ONE_WEEK,h.VISITOR,h.USER,h.HOV,h.LOV,h.CUSTOMER_WITH_ONE_ORDER,h.CUSTOMER,h.ALL_VISITORS],E={home:"/",collection:"/collections",products:"/products",cart:"/cart",checkout:"/checkouts",blogs:"/blogs"},g={home:"HOME_PAGE",collection:"COLLECTION_PAGE",products:"PRODUCT_PAGE",cart:"CART_PAGE",checkout:"CHECKOUT_PAGE",blogs:"BLOG_PAGE",others:"OTHER_PAGES"};function y(){const e=location.pathname;return e===E.home?g.home:e.includes(E.products)?g.products:e.includes(E.collection)?g.collection:e.includes(E.cart)?g.cart:e.includes(E.checkout)?g.checkout:e.includes(E.blogs)?g.blogs:g.others}const R={SERVER_BASE_URL:"http://localhost:8000",FINGER_PRINT_API_KEY:"6akvYQvuLuYvuj4CpMHb",DATA_SERVICE_URL:"http://localhost:3000",CLIENT_URL:"http://localhost:5174"};var _,O={exports:{}},w=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}},T=w,I=Object.prototype.toString,b=(_=Object.create(null),function(e){var t=I.call(e);return _[t]||(_[t]=t.slice(8,-1).toLowerCase())});function S(e){return e=e.toLowerCase(),function(t){return b(t)===e}}function A(e){return Array.isArray(e)}function N(e){return void 0===e}var C=S("ArrayBuffer");function L(e){return null!==e&&"object"==typeof e}function D(e){if("object"!==b(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}var U=S("Date"),P=S("File"),j=S("Blob"),B=S("FileList");function V(e){return"[object Function]"===I.call(e)}var k=S("URLSearchParams");function x(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),A(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}var M,F=(M="undefined"!=typeof Uint8Array&&Object.getPrototypeOf(Uint8Array),function(e){return M&&e instanceof M}),q={isArray:A,isArrayBuffer:C,isBuffer:function(e){return null!==e&&!N(e)&&null!==e.constructor&&!N(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){var t="[object FormData]";return e&&("function"==typeof FormData&&e instanceof FormData||I.call(e)===t||V(e.toString)&&e.toString()===t)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&C(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:L,isPlainObject:D,isUndefined:N,isDate:U,isFile:P,isBlob:j,isFunction:V,isStream:function(e){return L(e)&&V(e.pipe)},isURLSearchParams:k,isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:x,merge:function e(){var t={};function n(n,r){D(t[r])&&D(n)?t[r]=e(t[r],n):D(n)?t[r]=e({},n):A(n)?t[r]=n.slice():t[r]=n}for(var r=0,o=arguments.length;r<o;r++)x(arguments[r],n);return t},extend:function(e,t,n){return x(t,(function(t,r){e[r]=n&&"function"==typeof t?T(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,n,r){e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,n&&Object.assign(e.prototype,n)},toFlatObject:function(e,t,n){var r,o,i,a={};t=t||{};do{for(o=(r=Object.getOwnPropertyNames(e)).length;o-- >0;)a[i=r[o]]||(t[i]=e[i],a[i]=!0);e=Object.getPrototypeOf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:b,kindOfTest:S,endsWith:function(e,t,n){e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;var r=e.indexOf(t,n);return-1!==r&&r===n},toArray:function(e){if(!e)return null;var t=e.length;if(N(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n},isTypedArray:F,isFileList:B},H=q;function K(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var G=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(H.isURLSearchParams(t))r=t.toString();else{var o=[];H.forEach(t,(function(e,t){null!=e&&(H.isArray(e)?t+="[]":e=[e],H.forEach(e,(function(e){H.isDate(e)?e=e.toISOString():H.isObject(e)&&(e=JSON.stringify(e)),o.push(K(t)+"="+K(e))})))})),r=o.join("&")}if(r){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e},W=q;function J(){this.handlers=[]}J.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},J.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},J.prototype.forEach=function(e){W.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var $=J,z=q,Y=q;function Q(e,t,n,r,o){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o)}Y.inherits(Q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var X=Q.prototype,Z={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(e){Z[e]={value:e}})),Object.defineProperties(Q,Z),Object.defineProperty(X,"isAxiosError",{value:!0}),Q.from=function(e,t,n,r,o,i){var a=Object.create(X);return Y.toFlatObject(e,a,(function(e){return e!==Error.prototype})),Q.call(a,e.message,t,n,r,o),a.name=e.name,i&&Object.assign(a,i),a};var ee=Q,te={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ne=q;var re=function(e,t){t=t||new FormData;var n=[];function r(e){return null===e?"":ne.isDate(e)?e.toISOString():ne.isArrayBuffer(e)||ne.isTypedArray(e)?"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}return function e(o,i){if(ne.isPlainObject(o)||ne.isArray(o)){if(-1!==n.indexOf(o))throw Error("Circular reference detected in "+i);n.push(o),ne.forEach(o,(function(n,o){if(!ne.isUndefined(n)){var a,s=i?i+"."+o:o;if(n&&!i&&"object"==typeof n)if(ne.endsWith(o,"{}"))n=JSON.stringify(n);else if(ne.endsWith(o,"[]")&&(a=ne.toArray(n)))return void a.forEach((function(e){!ne.isUndefined(e)&&t.append(s,r(e))}));e(n,s)}})),n.pop()}else t.append(i,r(o))}(e),t},oe=ee,ie=q,ae=ie.isStandardBrowserEnv()?{write:function(e,t,n,r,o,i){var a=[];a.push(e+"="+encodeURIComponent(t)),ie.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),ie.isString(r)&&a.push("path="+r),ie.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},se=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)},ue=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e},ce=function(e,t){return e&&!se(t)?ue(e,t):t},le=q,de=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],fe=q,pe=fe.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=fe.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0},ve=ee;function he(e){ve.call(this,null==e?"canceled":e,ve.ERR_CANCELED),this.name="CanceledError"}q.inherits(he,ve,{__CANCEL__:!0});var me=he,Ee=q,ge=function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new oe("Request failed with status code "+n.status,[oe.ERR_BAD_REQUEST,oe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)},ye=ae,Re=G,_e=ce,Oe=function(e){var t,n,r,o={};return e?(le.forEach(e.split("\n"),(function(e){if(r=e.indexOf(":"),t=le.trim(e.substr(0,r)).toLowerCase(),n=le.trim(e.substr(r+1)),t){if(o[t]&&de.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}})),o):o},we=pe,Te=te,Ie=ee,be=me,Se=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""},Ae=function(e){return new Promise((function(t,n){var r,o=e.data,i=e.headers,a=e.responseType;function s(){e.cancelToken&&e.cancelToken.unsubscribe(r),e.signal&&e.signal.removeEventListener("abort",r)}Ee.isFormData(o)&&Ee.isStandardBrowserEnv()&&delete i["Content-Type"];var u=new XMLHttpRequest;if(e.auth){var c=e.auth.username||"",l=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.Authorization="Basic "+btoa(c+":"+l)}var d=_e(e.baseURL,e.url);function f(){if(u){var r="getAllResponseHeaders"in u?Oe(u.getAllResponseHeaders()):null,o={data:a&&"text"!==a&&"json"!==a?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:r,config:e,request:u};ge((function(e){t(e),s()}),(function(e){n(e),s()}),o),u=null}}if(u.open(e.method.toUpperCase(),Re(d,e.params,e.paramsSerializer),!0),u.timeout=e.timeout,"onloadend"in u?u.onloadend=f:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(f)},u.onabort=function(){u&&(n(new Ie("Request aborted",Ie.ECONNABORTED,e,u)),u=null)},u.onerror=function(){n(new Ie("Network Error",Ie.ERR_NETWORK,e,u,u)),u=null},u.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||Te;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new Ie(t,r.clarifyTimeoutError?Ie.ETIMEDOUT:Ie.ECONNABORTED,e,u)),u=null},Ee.isStandardBrowserEnv()){var p=(e.withCredentials||we(d))&&e.xsrfCookieName?ye.read(e.xsrfCookieName):void 0;p&&(i[e.xsrfHeaderName]=p)}"setRequestHeader"in u&&Ee.forEach(i,(function(e,t){void 0===o&&"content-type"===t.toLowerCase()?delete i[t]:u.setRequestHeader(t,e)})),Ee.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),a&&"json"!==a&&(u.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&u.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(r=function(e){u&&(n(!e||e&&e.type?new be:e),u.abort(),u=null)},e.cancelToken&&e.cancelToken.subscribe(r),e.signal&&(e.signal.aborted?r():e.signal.addEventListener("abort",r))),o||(o=null);var v=Se(d);v&&-1===["http","https","file"].indexOf(v)?n(new Ie("Unsupported protocol "+v+":",Ie.ERR_BAD_REQUEST,e)):u.send(o)}))},Ne=q,Ce=function(e,t){z.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))},Le=ee,De=re,Ue={"Content-Type":"application/x-www-form-urlencoded"};function Pe(e,t){!Ne.isUndefined(e)&&Ne.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var je,Be={transitional:te,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(je=Ae),je),transformRequest:[function(e,t){if(Ce(t,"Accept"),Ce(t,"Content-Type"),Ne.isFormData(e)||Ne.isArrayBuffer(e)||Ne.isBuffer(e)||Ne.isStream(e)||Ne.isFile(e)||Ne.isBlob(e))return e;if(Ne.isArrayBufferView(e))return e.buffer;if(Ne.isURLSearchParams(e))return Pe(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var n,r=Ne.isObject(e),o=t&&t["Content-Type"];if((n=Ne.isFileList(e))||r&&"multipart/form-data"===o){var i=this.env&&this.env.FormData;return De(n?{"files[]":e}:e,i&&new i)}return r||"application/json"===o?(Pe(t,"application/json"),function(e,t,n){if(Ne.isString(e))try{return(t||JSON.parse)(e),Ne.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||Be.transitional,n=t&&t.silentJSONParsing,r=t&&t.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||r&&Ne.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw Le.from(e,Le.ERR_BAD_RESPONSE,this,null,this.response);throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:null},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Ne.forEach(["delete","get","head"],(function(e){Be.headers[e]={}})),Ne.forEach(["post","put","patch"],(function(e){Be.headers[e]=Ne.merge(Ue)}));var Ve=Be,ke=q,xe=Ve,Me=function(e){return!(!e||!e.__CANCEL__)},Fe=q,qe=function(e,t,n){var r=this||xe;return ke.forEach(n,(function(n){e=n.call(r,e,t)})),e},He=Me,Ke=Ve,Ge=me;function We(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ge}var Je=q,$e=function(e,t){t=t||{};var n={};function r(e,t){return Je.isPlainObject(e)&&Je.isPlainObject(t)?Je.merge(e,t):Je.isPlainObject(t)?Je.merge({},t):Je.isArray(t)?t.slice():t}function o(n){return Je.isUndefined(t[n])?Je.isUndefined(e[n])?void 0:r(void 0,e[n]):r(e[n],t[n])}function i(e){if(!Je.isUndefined(t[e]))return r(void 0,t[e])}function a(n){return Je.isUndefined(t[n])?Je.isUndefined(e[n])?void 0:r(void 0,e[n]):r(void 0,t[n])}function s(n){return n in t?r(e[n],t[n]):n in e?r(void 0,e[n]):void 0}var u={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s};return Je.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=u[e]||o,r=t(e);Je.isUndefined(r)&&t!==s||(n[e]=r)})),n},ze="0.27.2",Ye=ze,Qe=ee,Xe={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){Xe[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var Ze={};Xe.transitional=function(e,t,n){function r(e,t){return"[Axios v"+Ye+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,o,i){if(!1===e)throw new Qe(r(o," has been removed"+(t?" in "+t:"")),Qe.ERR_DEPRECATED);return t&&!Ze[o]&&(Ze[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,o,i)}};var et={assertOptions:function(e,t,n){if("object"!=typeof e)throw new Qe("options must be an object",Qe.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(e),o=r.length;o-- >0;){var i=r[o],a=t[i];if(a){var s=e[i],u=void 0===s||a(s,i,e);if(!0!==u)throw new Qe("option "+i+" must be "+u,Qe.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new Qe("Unknown option "+i,Qe.ERR_BAD_OPTION)}},validators:Xe},tt=q,nt=G,rt=$,ot=function(e){return We(e),e.headers=e.headers||{},e.data=qe.call(e,e.data,e.headers,e.transformRequest),e.headers=Fe.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Fe.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||Ke.adapter)(e).then((function(t){return We(e),t.data=qe.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return He(t)||(We(e),t&&t.response&&(t.response.data=qe.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},it=$e,at=ce,st=et,ut=st.validators;function ct(e){this.defaults=e,this.interceptors={request:new rt,response:new rt}}ct.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=it(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=t.transitional;void 0!==n&&st.assertOptions(n,{silentJSONParsing:ut.transitional(ut.boolean),forcedJSONParsing:ut.transitional(ut.boolean),clarifyTimeoutError:ut.transitional(ut.boolean)},!1);var r=[],o=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,r.unshift(e.fulfilled,e.rejected))}));var i,a=[];if(this.interceptors.response.forEach((function(e){a.push(e.fulfilled,e.rejected)})),!o){var s=[ot,void 0];for(Array.prototype.unshift.apply(s,r),s=s.concat(a),i=Promise.resolve(t);s.length;)i=i.then(s.shift(),s.shift());return i}for(var u=t;r.length;){var c=r.shift(),l=r.shift();try{u=c(u)}catch(e){l(e);break}}try{i=ot(u)}catch(e){return Promise.reject(e)}for(;a.length;)i=i.then(a.shift(),a.shift());return i},ct.prototype.getUri=function(e){e=it(this.defaults,e);var t=at(e.baseURL,e.url);return nt(t,e.params,e.paramsSerializer)},tt.forEach(["delete","get","head","options"],(function(e){ct.prototype[e]=function(t,n){return this.request(it(n||{},{method:e,url:t,data:(n||{}).data}))}})),tt.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,o){return this.request(it(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}ct.prototype[e]=t(),ct.prototype[e+"Form"]=t(!0)}));var lt=ct,dt=me;function ft(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,r=n._listeners.length;for(t=0;t<r;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e){n.reason||(n.reason=new dt(e),t(n.reason))}))}ft.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},ft.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},ft.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},ft.source=function(){var e,t=new ft((function(t){e=t}));return{token:t,cancel:e}};var pt=ft,vt=q,ht=q,mt=w,Et=lt,gt=$e;var yt=function e(t){var n=new Et(t),r=mt(Et.prototype.request,n);return ht.extend(r,Et.prototype,n),ht.extend(r,n),r.create=function(n){return e(gt(t,n))},r}(Ve);yt.Axios=Et,yt.CanceledError=me,yt.CancelToken=pt,yt.isCancel=Me,yt.VERSION=ze,yt.toFormData=re,yt.AxiosError=ee,yt.Cancel=yt.CanceledError,yt.all=function(e){return Promise.all(e)},yt.spread=function(e){return function(t){return e.apply(null,t)}},yt.isAxiosError=function(e){return vt.isObject(e)&&!0===e.isAxiosError},O.exports=yt,O.exports.default=yt;var Rt=O.exports;const _t=new Set(["ENOTFOUND","ENETUNREACH","UNABLE_TO_GET_ISSUER_CERT","UNABLE_TO_GET_CRL","UNABLE_TO_DECRYPT_CERT_SIGNATURE","UNABLE_TO_DECRYPT_CRL_SIGNATURE","UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY","CERT_SIGNATURE_FAILURE","CRL_SIGNATURE_FAILURE","CERT_NOT_YET_VALID","CERT_HAS_EXPIRED","CRL_NOT_YET_VALID","CRL_HAS_EXPIRED","ERROR_IN_CERT_NOT_BEFORE_FIELD","ERROR_IN_CERT_NOT_AFTER_FIELD","ERROR_IN_CRL_LAST_UPDATE_FIELD","ERROR_IN_CRL_NEXT_UPDATE_FIELD","OUT_OF_MEM","DEPTH_ZERO_SELF_SIGNED_CERT","SELF_SIGNED_CERT_IN_CHAIN","UNABLE_TO_GET_ISSUER_CERT_LOCALLY","UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_CHAIN_TOO_LONG","CERT_REVOKED","INVALID_CA","PATH_LENGTH_EXCEEDED","INVALID_PURPOSE","CERT_UNTRUSTED","CERT_REJECTED","HOSTNAME_MISMATCH"]);var Ot=e=>!_t.has(e&&e.code);function wt(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function Tt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){wt(i,r,o,a,s,"next",e)}function s(e){wt(i,r,o,a,s,"throw",e)}a(void 0)}))}}function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var At="axios-retry";function Nt(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&Ot(e)}var Ct=["get","head","options"],Lt=Ct.concat(["put","delete"]);function Dt(e){return"ECONNABORTED"!==e.code&&(!e.response||e.response.status>=500&&e.response.status<=599)}function Ut(e){return!!e.config&&(Dt(e)&&-1!==Lt.indexOf(e.config.method))}function Pt(e){return Nt(e)||Ut(e)}function jt(){return 0}function Bt(e){var t=e[At]||{};return t.retryCount=t.retryCount||0,e[At]=t,t}function Vt(){return(Vt=Tt((function*(e,t,n,r){var o=n.retryCount<e&&t(r);if("object"==typeof o)try{return!1!==(yield o)}catch(e){return!1}return o}))).apply(this,arguments)}function kt(e,t){e.interceptors.request.use((e=>(Bt(e).lastRequestTime=Date.now(),e))),e.interceptors.response.use(null,function(){var n=Tt((function*(n){var{config:r}=n;if(!r)return Promise.reject(n);var{retries:o=3,retryCondition:i=Pt,retryDelay:a=jt,shouldResetTimeout:s=!1,onRetry:u=(()=>{})}=function(e,t){return bt(bt({},t),e[At])}(r,t),c=Bt(r);if(yield function(e,t,n,r){return Vt.apply(this,arguments)}(o,i,c,n)){c.retryCount+=1;var l=a(c.retryCount,n);if(function(e,t){e.defaults.agent===t.agent&&delete t.agent,e.defaults.httpAgent===t.httpAgent&&delete t.httpAgent,e.defaults.httpsAgent===t.httpsAgent&&delete t.httpsAgent}(e,r),!s&&r.timeout&&c.lastRequestTime){var d=Date.now()-c.lastRequestTime,f=r.timeout-d-l;if(f<=0)return Promise.reject(n);r.timeout=f}return r.transformRequest=[e=>e],u(c.retryCount,n,r),new Promise((t=>setTimeout((()=>t(e(r))),l)))}return Promise.reject(n)}));return function(e){return n.apply(this,arguments)}}())}kt.isNetworkError=Nt,kt.isSafeRequestError=function(e){return!!e.config&&(Dt(e)&&-1!==Ct.indexOf(e.config.method))},kt.isIdempotentRequestError=Ut,kt.isNetworkOrIdempotentRequestError=Pt,kt.exponentialDelay=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=100*Math.pow(2,e);return t+.2*t*Math.random()},kt.isRetryableError=Dt,kt(Rt,{retries:3,retryDelay:kt.exponentialDelay,shouldResetTimeout:!0,retryCondition:e=>!0});const xt=(e,t)=>n(void 0,void 0,void 0,(function*(){return e?(t||(t={}),yield Rt.get(e,{headers:Object.assign({"Content-Type":"application/json"},t)}).then((e=>({success:!0,data:e.data}))).catch((e=>({success:!1,error:e})))):{message:"url missing!"}})),Mt=(e,t,r)=>n(void 0,void 0,void 0,(function*(){return e?(r||(r={}),t||(t={}),yield Rt.post(e,r,{headers:Object.assign({"Content-Type":"application/json"},t)}).then((e=>({success:!0,data:e.data}))).catch((function(e){return{success:!0,data:e.data}}))):{message:"url missing!"}})),Ft=e=>n(void 0,void 0,void 0,(function*(){var t;try{if(e){const n=yield xt(`${R.SERVER_BASE_URL}/core/segments/${e}`),r=null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.data;return r||{segments:{}}}return{segments:{}}}catch(e){return console.log(e),null}}));function qt(e){for(var t="",n=0;n<e.length;++n)if(n>0){var r=e[n].toLowerCase();r!==e[n]?t+=" ".concat(r):t+=e[n]}else t+=e[n].toUpperCase();return t}var Ht="Blocked by CSP",Kt=qt("WrongRegion"),Gt=qt("SubscriptionNotActive"),Wt=qt("UnsupportedVersion"),Jt=qt("InstallationMethodRestricted"),$t="API key required",zt="API key not found",Yt="API key expired",Qt="9319";function Xt(e,t){var n=[];return function(e,t){var n,r,o=(r=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([],e,!0),{current:function(){return r[0]},postpone:function(){var e=r.shift();void 0!==e&&r.push(e)},exclude:function(){r.shift()}}),i=(100,3e3,n=0,function(){return Math.random()*Math.min(3e3,100*Math.pow(2,n++))}),a=o.current();if(void 0===a)return Promise.reject(new TypeError("The list of script URL patterns is empty"));var s=function(e,n){return t(e).catch((function(e){if(n+1>=5)throw e;!function(e){if(!(e instanceof Error))return!1;var t=e.message;return t===Ht||t===Qt}(e)?o.postpone():o.exclude();var t,r=o.current();if(void 0===r)throw e;return(t=i(),new Promise((function(e){return setTimeout(e,t)}))).then((function(){return s(r,n+1)}))}))};return s(a,0)}(e,(function(e){var r=new Date,o=function(t){return n.push({url:e,startedAt:r,finishedAt:new Date,error:t})},i=t(e);return i.then((function(){return o()}),o),i})).then((function(e){return[e,{attempts:n}]}))}var Zt="https://fpnpmcdn.net/v<version>/<apiKey>/loader_v<loaderVersion>.js",en="Failed to load the JS script of the agent";function tn(e){return function(e,t,n,r){var o,i=document,a="securitypolicyviolation",s=function(t){var n=new URL(e,location.href),r=t.blockedURI;r!==n.href&&r!==n.protocol.slice(0,-1)&&r!==n.origin||(o=t,u())};i.addEventListener(a,s);var u=function(){return i.removeEventListener(a,s)};return Promise.resolve().then(t).then((function(e){return u(),e}),(function(e){return new Promise((function(e){return setTimeout(e)})).then((function(){if(u(),o)return function(){throw new Error(Ht)}();throw e}))}))}(e,(function(){return function(e){return new Promise((function(t,n){var r=document.createElement("script"),o=function(){var e;return null===(e=r.parentNode)||void 0===e?void 0:e.removeChild(r)},i=document.head||document.getElementsByTagName("head")[0];r.onload=function(){o(),t()},r.onerror=function(){o(),n(new Error(en))},r.async=!0,r.src=e,i.appendChild(r)}))}(e)})).then(nn)}function nn(){var e=window,t="__fpjs_p_l_b",n=e[t];if(function(e,t){var n,r=null===(n=Object.getOwnPropertyDescriptor)||void 0===n?void 0:n.call(Object,e,t);(null==r?void 0:r.configurable)?delete e[t]:r&&!r.writable||(e[t]=void 0)}(e,t),"function"!=typeof(null==n?void 0:n.load))throw new Error(Qt);return n}function rn(e){throw e instanceof Error&&e.message===Qt?new Error(en):e}var on={load:function(e){var n;e.scriptUrlPattern;var r=e.token,o=e.apiKey,i=void 0===o?r:o,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["scriptUrlPattern","token","apiKey"]),s=null!==(n=function(e,t){return function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t)?e[t]:void 0}(e,"scriptUrlPattern"))&&void 0!==n?n:Zt;return Promise.resolve().then((function(){if(!i||"string"!=typeof i)throw new Error($t);return Xt(function(e,t){return(Array.isArray(e)?e:[e]).map((function(e){return function(e,t){var n=encodeURIComponent;return e.replace(/<[^<>]+>/g,(function(e){return"<version>"===e?"3":"<apiKey>"===e?n(t):"<loaderVersion>"===e?n("3.8.5"):e}))}(String(e),t)}))}(s,i),tn).catch(rn)})).then((function(e){var n=e[0],r=e[1];return n.load(t(t({},a),{ldi:r}))}))},defaultScriptUrlPattern:Zt,ERROR_SCRIPT_LOAD_FAIL:en,ERROR_API_KEY_EXPIRED:Yt,ERROR_API_KEY_INVALID:zt,ERROR_API_KEY_MISSING:$t,ERROR_BAD_REQUEST_FORMAT:"Request cannot be parsed",ERROR_BAD_RESPONSE_FORMAT:"Response cannot be parsed",ERROR_CLIENT_TIMEOUT:"Client timeout",ERROR_CSP_BLOCK:Ht,ERROR_FORBIDDEN_ENDPOINT:qt("HostnameRestricted"),ERROR_FORBIDDEN_HEADER:"Not available with restricted header",ERROR_FORBIDDEN_ORIGIN:"Not available for this origin",ERROR_GENERAL_SERVER_FAILURE:"Request failed",ERROR_INSTALLATION_METHOD_RESTRICTED:Jt,ERROR_INTEGRATION_FAILURE:qt("IntegrationFailed"),ERROR_INVALID_ENDPOINT:"The endpoint parameter is not a valid URL",ERROR_NETWORK_ABORT:"Network request aborted",ERROR_NETWORK_CONNECTION:"Network connection error",ERROR_RATE_LIMIT:"Too many requests, rate limit exceeded",ERROR_SERVER_TIMEOUT:"Request failed to process",ERROR_SUBSCRIPTION_NOT_ACTIVE:Gt,ERROR_TOKEN_EXPIRED:Yt,ERROR_TOKEN_INVALID:zt,ERROR_TOKEN_MISSING:$t,ERROR_UNSUPPORTED_VERSION:Wt,ERROR_WRONG_REGION:Kt,defaultEndpoint:{default:"endpoint"},defaultTlsEndpoint:{default:"tlsEndpoint"}};const an=new r(window.localStorage);let sn;const un=new Uint8Array(16);function cn(){if(!sn&&(sn="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!sn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return sn(un)}const ln=[];for(let e=0;e<256;++e)ln.push((e+256).toString(16).slice(1));var dn={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function fn(e,t,n){if(dn.randomUUID&&!t&&!e)return dn.randomUUID();const r=(e=e||{}).random||(e.rng||cn)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(ln[e[t+0]]+ln[e[t+1]]+ln[e[t+2]]+ln[e[t+3]]+"-"+ln[e[t+4]]+ln[e[t+5]]+"-"+ln[e[t+6]]+ln[e[t+7]]+"-"+ln[e[t+8]]+ln[e[t+9]]+"-"+ln[e[t+10]]+ln[e[t+11]]+ln[e[t+12]]+ln[e[t+13]]+ln[e[t+14]]+ln[e[t+15]]).toLowerCase()}(r)}class pn{static generateId(){return fn()}}class vn{constructor(){this.anonymousId="",this.userId=""}static getInstance(){return vn.instance||(vn.instance=new vn),vn.instance.setAnonymousId(),vn.instance.setUserId(),vn.instance}setAnonymousId(){if(this.getAnonymousId())return;const e=pn.generateId();return an.setItem(l,e),this.anonymousId=e,e}getAnonymousId(){var e;return this.anonymousId||(null===(e=an.getItem(l))||void 0===e?void 0:e.value)||""}setUserId(){var e,t,n;this.userId=(null===(n=null===(t=null===(e=null===window||void 0===window?void 0:window.ShopifyAnalytics)||void 0===e?void 0:e.meta)||void 0===t?void 0:t.page)||void 0===n?void 0:n.customerId)||""}getUserId(){return this.userId}}const hn=vn.getInstance();class mn{static setUserInformation(){return n(this,void 0,void 0,(function*(){try{if(!this.data){const{value:e}=an.getItem(c);if(e&&Object.keys(e).length)this.data=e;else{const e=hn.getAnonymousId(),t=hn.getUserId(),n=yield on.load({apiKey:R.FINGER_PRINT_API_KEY});if(n){const r=(yield n.get({extendedResult:!0,linkedId:e,tag:{userId:t,anonymousId:e}}))||void 0;r&&(an.setItem(c,r,6e4),this.data=r)}}}return this.data}catch(e){console.error("Error occurred while setting user information:",e)}}))}static getLocation(){return this.data?this.data.ipLocation:null}static getVisitorInfo(){return this.data}static getVisitorId(){return this.data?this.data.visitorId:null}static getVisitorFound(){if(this.data)return this.data.visitorFound}}mn.data=null;const En=(e,t,r)=>n(void 0,void 0,void 0,(function*(){var n,i;try{if(r)return[];const a=o.getItem(d);if((null===(n=null==a?void 0:a.value)||void 0===n?void 0:n.length)&&!t)return null==a?void 0:a.value;const s=yield xt(`${R.SERVER_BASE_URL}/variants?${e}`),u=null==s?void 0:s.data;return(null===(i=null==u?void 0:u.data)||void 0===i?void 0:i.length)?(o.setItem(d,u.data),u.data):[]}catch(e){return console.log(e),[]}})),gn=e=>n(void 0,void 0,void 0,(function*(){var t;try{if(!(null===(t=null===document||void 0===document?void 0:document.currentScript)||void 0===t?void 0:t.getAttribute("data-preview-mode")))try{yield Mt(`${R.SERVER_BASE_URL}/businesses/customer-data`,{},e)}catch(e){}}catch(e){console.log(e)}}));function yn(e){try{if(e){let t=document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);if(t.singleNodeValue)return t.singleNodeValue;throw new Error(`No element found for XPath: ${e}`)}return null}catch(e){return console.error(e),null}}function Rn(e){if(""!==e.id&&"string"==typeof e.id)return'//*[@id="'+e.id+'"]';if(e===document.body)return e.tagName.toLowerCase();for(var t=0,n=e.parentNode.childNodes,r=0;r<n.length;r++){var o=n[r];if(o===e)return Rn(e.parentNode)+"/"+e.tagName.toLowerCase()+"["+(t+1)+"]";1===o.nodeType&&o.tagName===e.tagName&&t++}}function _n(e){if("HTML"==e.tagName)return"/HTML";if(e===document.body)return"/HTML/BODY";for(var t=0,n=e.parentNode.childNodes,r=0;r<n.length;r++){var o=n[r];if(o===e)return _n(e.parentNode)+"/"+e.tagName+"["+(t+1)+"]";1===o.nodeType&&o.tagName===e.tagName&&t++}}function On({visitorCity:e}){return n(this,void 0,void 0,(function*(){let t,r=document.createElement("div"),o=document.createElement("script"),i=!1;function a(e){e.preventDefault();const t=e.target;console.log("HANDLE MOUSE OVER"),t===r||r.contains(t)||(t.dataset.originalBgColor=t.style.backgroundColor,t.style.transition="background-color 0.3s",t.style.backgroundColor="#bfe4ff")}function s(e){var t;e.preventDefault();const n=e.target;if(n===r||r.contains(n))return;const o=null===(t=null==n?void 0:n.dataset)||void 0===t?void 0:t.originalBgColor;console.log("HANDLE MOUSE OOUT"),n.style.transition="",n.style.backgroundColor=o||"",n.dataset.originalBgColor=""}function u(e,r,o="afterend",i){var a;return n(this,void 0,void 0,(function*(){console.log("updatePlacement !!!!!!!");document.contains(r)&&r.remove(),"A"===e.target.tagName&&e.preventDefault();const n=e.target,s=yield Rn(n),u=yield _n(n);console.log("clickedElement",{event:n,position:o,fullXpath:s,xpath:u}),null===(a=e.target)||void 0===a||a.insertAdjacentElement(o||"afterend",r),window.top.postMessage({messageType:"element-xpath",data:{fullXpath:s,xpath:u}},R.CLIENT_URL),setTimeout((()=>{r.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}),document.body.prepend(i)}),500),t=e}))}function c(e,n="afterend",r,o=!1){console.log("attachClickEventAndFindXPath"),o||u(t,e,n,r),document.addEventListener("click",(function t(o){u(o,e,n,r),function(){if(!i)return;i=!1,document.removeEventListener("mouseover",a)}(),document.removeEventListener("click",t)}))}try{window.top!==window&&(window.top!==window&&window.top.postMessage({messageType:"script-loaded"},R.CLIENT_URL),window.addEventListener("message",(t=>n(this,void 0,void 0,(function*(){var n,u,l,d,f,p,v,h,m,E,g,R,_,O,w,T,I,b,S,A,N,C,L;if("render-use-case"===t.data.messageType){const i=(null===(u=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.data)||void 0===u?void 0:u.template)||{html:"",css:"",_id:""},a=null===(d=null===(l=null==t?void 0:t.data)||void 0===l?void 0:l.data)||void 0===d?void 0:d.placement,s=null===(p=null===(f=null==t?void 0:t.data)||void 0===f?void 0:f.data)||void 0===p?void 0:p.isDynamicPlacement,c=(null===(h=null===(v=null==t?void 0:t.data)||void 0===v?void 0:v.data)||void 0===h||h.placementIndex,(null===(E=null===(m=null==t?void 0:t.data)||void 0===m?void 0:m.data)||void 0===E?void 0:E.pages)||[]),O=y();if(c.includes(O)&&i&&(null==i?void 0:i.html)){const{html:t,css:n,_id:u,script:c}=i,l=document.getElementById(u);if(l){null==l||l.remove();const e=document.querySelector(`style[template-style-id='${u}']`);null==e||e.remove();const t=document.querySelector(`script[template-script-id='${u}']`);t&&(null==t||t.remove())}r.setAttribute("id",u),null===(g=r.children[0])||void 0===g||g.setAttribute("data-preview-mode",!0),r.innerHTML=t,r.style.width="100%";const d=document.createElement("style");d.setAttribute("template-style-id",u),d.innerText=n,null===(R=r.children[0])||void 0===R||R.setAttribute("data-preview-mode",!0);const f=[{id:"Product ID",city:"Bengaluru",title:"Shopify Product",final_price:"₹ {product.price}",product_URL:"{product.url}",product_image_URL:"https://dev.personalization.attryb.com/template-assets/placeholder_image.svg"},{id:"Product ID",city:"Bengaluru",title:"Shopify Product",final_price:"₹ {product.price}",product_URL:"{product.url}",product_image_URL:"https://dev.personalization.attryb.com/template-assets/placeholder_image.svg"},{id:"Product ID",city:"Bengaluru",title:"Shopify Product",final_price:"₹ {product.price}",product_URL:"{product.url}",product_image_URL:"https://dev.personalization.attryb.com/template-assets/placeholder_image.svg"}];f[0].city=e||"Bengaluru",null===(_=r.children[0])||void 0===_||_.setAttribute("data-template-display",JSON.stringify(f)),s||(yield document.body.prepend(r)),document.body.prepend(d),o.setAttribute("template-script-id",u),o.textContent=c,s||setTimeout((()=>{document.body.prepend(o)}),500),(null==a?void 0:a.value)&&(r.children[0].children[0].style.cssText=a.value)}}if("enable-inspector"===t.data.messageType&&(i||(i=!0,document.addEventListener("mouseover",a),document.addEventListener("mouseout",s)),c(r,null===(O=t.data)||void 0===O?void 0:O.data,o,!0)),"placments"===(null===(w=t.data)||void 0===w?void 0:w.messageType)){const e=(null===(I=null===(T=null==t?void 0:t.data)||void 0===T?void 0:T.data)||void 0===I?void 0:I.styles)||"",n=(null===(S=null===(b=null==t?void 0:t.data)||void 0===b?void 0:b.data)||void 0===S?void 0:S.template)||{html:"",css:"",_id:""},i=null===(N=null===(A=null==t?void 0:t.data)||void 0===A?void 0:A.data)||void 0===N?void 0:N.isDynamicPlacement,{_id:a}=(null===(L=null===(C=null==t?void 0:t.data)||void 0===C?void 0:C.data)||void 0===L||L.placementIndex,n),s=document.getElementById(a);i?c(r,e,o):s&&(s.children[0].children[0].style.cssText=e)}})))))}catch(e){console.log(e)}}))}const wn=e=>n(void 0,void 0,void 0,(function*(){var t;try{if(!(null===(t=null===document||void 0===document?void 0:document.currentScript)||void 0===t?void 0:t.getAttribute("data-preview-mode"))){const t=yield mn.getVisitorId(),n=hn.getAnonymousId(),r=hn.getUserId(),o=Object.assign(Object.assign({},e),{anonymousId:n,customerId:r,visitorId:t});yield Mt(`${R.SERVER_BASE_URL}/analytics/use-case`,{},o)}}catch(e){console.log(e)}})),Tn=e=>n(void 0,void 0,void 0,(function*(){var t;try{const n=yield xt(`${R.SERVER_BASE_URL}/analytics/use-case?${e}`);return null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.data}catch(e){console.log(e)}}));class In{constructor(){this.cdpPlatform=null===window||void 0===window?void 0:window.rudderanalytics}static getInstance(){return In.instance||(In.instance=new In),In.instance}track(e,t){var n;const r=null===(n=null===document||void 0===document?void 0:document.currentScript)||void 0===n?void 0:n.getAttribute("data-preview-mode");if(window.rudderanalytics&&!r)try{window.rudderanalytics.track(e,t)}catch(e){}}}const bn=In.getInstance(),Sn="attryb-banner-carousel",An={static:"static",dynamic:"dynamic"};function Nn(e){return e?document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue:null}function Cn(e,t,r,o,i,a){var s,u,c;return n(this,void 0,void 0,(function*(){try{let l=!1;e.addEventListener("click",(function(e){return n(this,void 0,void 0,(function*(){l||(wn(Object.assign({event:"click"},a)),bn.track(p.click,Object.assign(Object.assign({},a),{event:Object.assign({},e)})),l=!0)}))})),"Popup"===i&&e&&e.addEventListener("submit",(e=>function(e,t){e.preventDefault();const n=e.target.querySelectorAll("input"),r={};n.forEach((e=>{r[e.name]=e.value})),gn(Object.assign(Object.assign({},r),t)),bn.track(p.formSubmit,Object.assign(Object.assign({},r),t))}(e,a))),e.children[0].style.cssText=t;const d=document.createElement("style");if(d.innerText=r,yield null===(s=null===document||void 0===document?void 0:document.body)||void 0===s?void 0:s.prepend(d),"banner"===i){let f,v=document.querySelector(`.${Sn}`);v?f=v:(f=document.createElement("div"),f.setAttribute("class",Sn),yield null===(u=null===document||void 0===document?void 0:document.body)||void 0===u?void 0:u.prepend(f)),yield f.prepend(e);let h=0,m=v;function E(){if(m){let e=null==m?void 0:m.children;if(e){for(let t=0;t<e.length;t++)e[t].style.display="none";h++,h>e.length&&(h=1),e[h-1].style.display="block",setTimeout(E,4e3)}}}E()}else yield null===(c=null===document||void 0===document?void 0:document.body)||void 0===c?void 0:c.prepend(e);setTimeout((()=>{var e;const t=document.createElement("script");t.textContent=o,null===(e=null===document||void 0===document?void 0:document.body)||void 0===e||e.prepend(t)}),500),wn(Object.assign({event:"load"},a)),bn.track(p.load,Object.assign({},a))}catch(g){console.log(g)}}))}const Ln="load",Dn="time_on_page",Un="time_of_visit",Pn="exit_intent";class jn{constructor(e,t){var n;this.status=[],this.triggers=[],this.renderElm=()=>{},this.triggers=e;const r=[];for(let t=0;t<e.length;t++){const o=(null===(n=e[t])||void 0===n?void 0:n.length)||0;let i=new Array(o).fill(0);r.push(i)}this.status=r,this.renderElm=t,this.evaluateTriggers()}evaluateTriggers(){try{const e=this.triggers;for(let t=0;t<e.length;t++){let n=e[t];for(let e=0;e<n.length;e++){let r=n[e];"Event"===r.type&&this.registerEvent(r,[t,e])}}}catch(e){console.log(e)}}registerEvent(e={},t=[]){var n;const{data:r,device:o,type:i}=e,{expression:a,event:s}=r;if(s.event===Ln)return void this.eventHandler({},e,t);if(s.event===Dn){const r=1e3*parseInt(null===(n=a.value)||void 0===n?void 0:n.min);let o;return void(o=setTimeout((()=>{this.eventHandler({},e,t),clearTimeout(o)}),r))}if(s.event===Un){return void(function(e){const t=new Date;return t.getTime()+6e4*t.getTimezoneOffset()>=e}(null===value||void 0===value?void 0:value.min)&&this.eventHandler({},e,t))}let u=window;if(s.target){const e=s.target.element;"id"===s.target.type?u=document.getElementById(e):"xpath"===s.target.type&&(u=yn(e))}if(u){const n=n=>{const r={};var o;"scroll"===n.type&&(r.scrollDepth=(o=window.pageYOffset/(document.documentElement.scrollHeight-window.innerHeight)*100,Math.round(o)));const{variable:i,operator:s,value:u}=a;let c=!0;a&&i&&s&&(null==u?void 0:u.min)&&(null==u?void 0:u.max)&&(c=function({variable:e,operator:t,value:n},r){return"equal"===t?r[e]==parseInt(n.min):"greater"===t?r[e]>parseInt(n.min):"less"===t?r[e]<parseInt(n.min):"range"===t&&r[e]>=parseInt(n.min)&&r[e]<=parseInt(n.max)}({variable:i,operator:s,value:u},r)),"mouseout"===n.type&&(c=n.clientY<=0),c&&this.eventHandler(n,e,t)};u.addEventListener(s.event,n),e.eventListener=n}}eventHandler(e,t,n=[]){const[r,o]=n;this.status[r][o]=1;this.checkTriggerStatus(r)&&(this.renderElm(),this.detachEvents())}checkTriggerStatus(e){const t=this.status[e];for(let e=0;e<t.length;e++){if(!t[e])return!1}return!0}detachEvents(){const e=this.triggers;for(let t=0;t<e.length;t++){let n=e[t];for(let e=0;e<n.length;e++){let r=n[e];"Event"===r.type&&this.detachEvent(r,[t,e])}}}detachEvent(e,[t,n]){const{data:r,device:o,type:i}=e,{expression:a,event:s}=r;let u=window;if(s.target){const e=s.target.element;"id"===s.target.type?u=document.getElementById(e):"xpath"===s.target.type&&(u=yn(e))}s.event===Pn&&document.removeEventListener("mouseout",mouseEvent),u.removeEventListener(s.event,e.eventListener)}}const Bn=e=>n(void 0,void 0,void 0,(function*(){var t;try{if(null===window||void 0===window?void 0:window.Shopify){const n=`products/${window.location.pathname.split("products/")[1]}.js`,r=yield xt(window.Shopify.routes.root+n,{}),o=null==r?void 0:r.data,i=yield xt(`${R.DATA_SERVICE_URL}/api/histroicals/${e}/products/${null==o?void 0:o.id}/bought-together`);return(null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.data)||[]}}catch(e){return[]}}));function Vn(e,{visitorId:t,visitorFound:r,visitorCity:o,_isWithinLastWeek:i,countryCode:a},s,u,c){var l,d,p,m,E;return n(this,void 0,void 0,(function*(){const a=e.configuration.placement,g=a.type,y=e.configuration.triggers,R=e.configuration.frequency,{useCaseId:_,accountId:O,containerId:w,campaignId:T,_id:I,segmentId:b}=e,{html:S="",css:A,script:N,_id:C,viewStructure:L}=e.templateId;let D=[];(null==R?void 0:R.frequencyNum)&&(D=(yield Tn(`event=load&variantId=${I}&visitorId=${t}`))||[]);let U=!1;if(void 0===r||(null==b?void 0:b.name)!==h.NEW_VISITOR||r||(U=!0),(null==b?void 0:b.name)===h.USER&&s&&(U=!0),(null===(l=null==u?void 0:u.segments)||void 0===l?void 0:l.FIRST_TIME_CUSTOMER)&&b.name.CUSTOMER_WITH_ONE_ORDER===h.CUSTOMER_WITH_ONE_ORDER&&(U=!0),(null===(d=null==u?void 0:u.segments)||void 0===d?void 0:d.CUSTOMER)&&(null==b?void 0:b.name)===h.CUSTOMER&&s&&(U=!0),(null===(p=null==u?void 0:u.segments)||void 0===p?void 0:p.HOV)&&b.name===h.HOV&&(U=!0),(null===(m=null==u?void 0:u.segments)||void 0===m?void 0:m.LOV)&&b.name===h.LOV&&(U=!0),b.name!==h.VISITOR||s||(U=!0),b.name===h.TIER_1&&f.tier1.includes(o)&&(U=!0),b.name===h.TIER_2&&f.tier2.includes(o)&&(U=!0),b.name!==h.TIER_3||f.tier1.includes(o)||f.tier2.includes(o)||(U=!0),b.name!==h.VISITOR_LAST_SEEN_GREATER_THAN_ONE_WEEK||i||(U=!0),b.name===h.VISITOR_LAST_SEEN_LESS_THAN_ONE_WEEK&&i&&(U=!0),b.name===h.ALL_VISITORS&&(U=!0),(null==R?void 0:R.frequencyNum)&&parseInt(R.frequencyNum)>D.length?U=!0:(null==R?void 0:R.frequencyNum)&&parseInt(R.frequencyNum)<=D.length&&(U=!1),U){const j=(P=S,(new DOMParser).parseFromString(P,"text/html")).documentElement.querySelector("body").children[0];if(c){yield j.setAttribute("data-preview-mode",!0);const k=[{id:"Product ID",city:"Bengaluru",title:"Shopify Product",final_price:"₹ {product.price}",product_URL:"{product.url}",product_image_URL:"https://dev.personalization.attryb.com/template-assets/placeholder_image.svg"},{id:"Product ID",city:"Bengaluru",title:"Shopify Product",final_price:"₹ {product.price}",product_URL:"{product.url}",product_image_URL:"https://dev.personalization.attryb.com/template-assets/placeholder_image.svg"},{id:"Product ID",city:"Bengaluru",title:"Shopify Product",final_price:"₹ {product.price}",product_URL:"{product.url}",product_image_URL:"https://dev.personalization.attryb.com/template-assets/placeholder_image.svg"}];k[0].city=o||"Bengaluru",yield j.setAttribute("data-template-display",JSON.stringify(k))}if(!c){if(_.name===v.locationBestSeller){const x=[{id:"Product ID",city:"Bengaluru",title:"Shopify Product",final_price:"₹ {product.price}",product_URL:"{product.url}",product_image_URL:"https://dev.personalization.attryb.com/template-assets/placeholder_image.svg"},{id:"Product ID",city:"Bengaluru",title:"Shopify Product",final_price:"₹ {product.price}",product_URL:"{product.url}",product_image_URL:"https://dev.personalization.attryb.com/template-assets/placeholder_image.svg"},{id:"Product ID",city:"Bengaluru",title:"Shopify Product",final_price:"₹ {product.price}",product_URL:"{product.url}",product_image_URL:"https://dev.personalization.attryb.com/template-assets/placeholder_image.svg"}];x[0].city=o||"Bengaluru",yield j.setAttribute("data-template-display",JSON.stringify(x))}if(_.name===v.frequentlyBoughtTogether){const M=yield Bn(w);yield j.setAttribute("data-template-display",JSON.stringify((null===(E=M[0])||void 0===E?void 0:E.data)||[]))}}function B(){!function(e,t,r,o,i,a,s){n(this,void 0,void 0,(function*(){e===An.static?(null===document||void 0===document?void 0:document.body)?Cn(t,r,o,i,a,s):document.addEventListener("DOMContentLoaded",(function(){Cn(t,r,o,i,a,s)})):e===An.dynamic&&setTimeout((()=>n(this,void 0,void 0,(function*(){var e;const n=Nn(r.xPath)||Nn(r.fullXpath);console.log("clientElement",n),console.log("dynamic placement"),console.log("placementStyles.xPath",r),yield null==n?void 0:n.insertAdjacentElement(r.position||"afterbegin",t);const a=document.createElement("style");a.innerText=o,yield null===(e=null===document||void 0===document?void 0:document.body)||void 0===e?void 0:e.prepend(a),setTimeout((()=>{var e;const t=document.createElement("script");t.textContent=i,console.log("SCRIPE",i),null===(e=null===document||void 0===document?void 0:document.body)||void 0===e||e.prepend(t)}),1e3)}))),1e3)}))}(g,j,a.value,A,N,L,{useCaseId:null==_?void 0:_._id,accountId:O,containerId:w,campaignId:null==T?void 0:T._id,variantId:I,visitorId:t,segmentId:null==b?void 0:b._id})}function V(){var t,n;"popup"===L?("QUEUE"===e.configuration.overlap.type?window.attryb.ViewStructureQueue[L].enqueue({variant:e,callback:()=>{B()}}):"FORCE_OVERLAP"===e.configuration.overlap.type?(window.attryb.ViewStructureQueue[L].increaseCounter(),window.attryb.ViewStructureQueue[L].resetCooldown(),B()):"NOT_IN_CURRENT_SESSION"!==e.configuration.overlap.type||(null===(t=window.attryb)||void 0===t?void 0:t.ViewStructureTrack.checkViewstructureDisplayed(L))||(null===(n=window.attryb)||void 0===n?void 0:n.ViewStructureQueue[L].checkOverlap())||(window.attryb.ViewStructureQueue[L].increaseCounter(),window.attryb.ViewStructureQueue[L].resetCooldown(),B()),window.attryb.ViewStructureTrack.updateViewStructure(L,!0)):B()}yield j.setAttribute("data-configuration",JSON.stringify(e.configuration)),new jn(y,V)}var P}))}window.attryb={},function(){var e,t;try{if(!(null===(e=null===window||void 0===window?void 0:window.attryb)||void 0===e?void 0:e.ViewStructureQueue)){const e={popup:new u};window.attryb.ViewStructureQueue=e}if(!(null===(t=null===window||void 0===window?void 0:window.attryb)||void 0===t?void 0:t.ViewStructureTrack)){const e=new a;window.attryb.ViewStructureTrack=e}window.attryb.data_configuration="data-configuration",window.attryb.data_preview_mode="data-preview-mode",window.attryb.data_template_display="data-template-display",window.attryb.replacePlaceholders=(e,t)=>{const n=/\${{(.*?)}}/g;return e.map((e=>t.replace(n,((t,n)=>(null===e.compare_at_price?e.compare_at_price="":null===e.discount&&(e.discount=""),e.hasOwnProperty(n)?e[n]:t)))))},window.attryb.convertDomToString=e=>{if(e){return(new XMLSerializer).serializeToString(e)}},window.attryb.getRemainingTime=e=>{let t=new Date;var n;n=t,t=new Date(n.getTime()-6e4*n.getTimezoneOffset()).getTime();let r=Math.max(0,Math.floor((e-t)/1e3)),o=r%60,i=Math.floor(r/60%60),a=Math.floor(r/3600%24);return{total:r,days:Math.floor(r/86400),hours:a,minutes:i,seconds:o}}}catch(e){console.log(e)}}();function kn(){var e,t,r;return n(this,void 0,void 0,(function*(){try{const i=null===(e=null===document||void 0===document?void 0:document.currentScript)||void 0===e?void 0:e.getAttribute("data-preview-mode"),a=null===(t=null===document||void 0===document?void 0:document.currentScript)||void 0===t?void 0:t.getAttribute("data-placement-mode");let s=null===(r=null===document||void 0===document?void 0:document.currentScript)||void 0===r?void 0:r.getAttribute("containerid");if(!s){let e=`domainName=${window.Shopify.shop}`;const t=yield(e=>n(void 0,void 0,void 0,(function*(){var t;try{const n=yield xt(`${R.SERVER_BASE_URL}/containers?${e}`),r=null==n?void 0:n.data;return(null===(t=null==r?void 0:r.data)||void 0===t?void 0:t.length)?r.data[0]:[]}catch(e){return console.log(e),[]}})))(e);s=null==t?void 0:t._id}const u=y();if(s){const e=function(){const e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString()}(),t=hn.getUserId();Promise.all([En(`containerId=${s}&isDraft=false&status=active&currentDate=${e}`,i,a),Ft(t),mn.setUserInformation()]).then((e=>n(this,void 0,void 0,(function*(){var n,r,s,c,l;const[d,f]=e,p=yield mn.getVisitorFound(),v=yield mn.getVisitorId(),h=yield mn.getVisitorInfo(),E=(null===(r=null===(n=null==h?void 0:h.ipLocation)||void 0===n?void 0:n.city)||void 0===r?void 0:r.name)||"",g=null===(c=null===(s=null==h?void 0:h.ipLocation)||void 0===s?void 0:s.country)||void 0===c?void 0:c.code,y=function(e){if(!e)return!0;const t=new Date;return t.setDate(t.getDate()-7),new Date(e)>=t}((null===(l=null==h?void 0:h.lastSeenAt)||void 0===l?void 0:l.global)||"");if(i){a&&o.setItem("data-placement-mode",!0);const e=o.getItem("data-placement-mode");if((null==e?void 0:e.value)||a)return void function(e){(null===document||void 0===document?void 0:document.body)?On(e):window.addEventListener("load",(()=>{On(e)}))}({visitorCity:E})}const R=[];for(let e=0;e<d.length;e++){const t=d[e];for(let e=0;e<t.pages.length;e++)t.pages[e].page===u&&R.push(t)}const _=new Map;for(let e of R){const t=e.useCaseId._id,n=e.segmentId.name;if(_.has(t)){const r=_.get(t).priority,o=m.indexOf(n);o>r&&_.set(t,{item:e,segment:n,priority:o})}else _.set(t,{item:e,segment:n,priority:m.indexOf(n)})}const O=Array.from(_.values()).map((({item:e})=>e));for(let e of O)Vn(e,{visitorId:v,visitorFound:p,visitorCity:E,_isWithinLastWeek:y,countryCode:g},t,f,i)}))))}}catch(e){console.log(e)}}))}kn(),e.personalizeWeb=kn,Object.defineProperty(e,"__esModule",{value:!0})}));
